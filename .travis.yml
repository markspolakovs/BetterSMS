language: node_js
sudo: false
addons:
  chrome: stable
node_js:
- '10'
cache: yarn
script:
- yarn run build
after_success:
- set -e
- openssl aes-256-cbc -K $encrypted_0373efeb2806_key -iv $encrypted_0373efeb2806_iv -in packaging-key.pem.enc -out packaging-key.pem -d
- wget https://github.com/mcuadros/go-crxmake/releases/download/v0.2.0/crxmake_v0.2.0_linux_amd64.tar.gz
- tar -xvzf crxmake_v0.2.0_linux_amd64.tar.gz
- cp crxmake_v0.2.0_linux_amd64/crxmake /usr/local/bin/
- crxmake --key-file=packaging-key.pem dist better-sms-${TRAVIS_COMMIT}.crx
deploy:
  provider: releases
  api_key:
    secure: laVZ12KIblCG+m2P+m7gbJh/1Sbt+4oixymyNetjJ35wVz7hh64hqGJyLkJKbsL13kHKtYrSgUcPhlJ3ehH6Hs9JQPPCX9uaIQfKgngMW6x/DqUc4gXgVeRbNXCinyfX4xCVzawFDRA30yGEUs816tUZTH9qa+3ze9Z0IvET/dgLOAMjwrfqtuaJ8cuX5fiV2ioTWgHv0ff0ZJP3BISgc/XXZFF6dLem6Q7DOO+EqBuVRFBBLZ67uccsm8qMRUAljTI3oP8E9vVye4Bwn5K33BrmiuOJeoR6yauKlgXo4wx6kRf2QPfTtzZKx+jr+TJwinRWy6I7ojCvdA9JWIu4/HEQWB4TK7BMHL4BLWET3oeLngpRhN8I6kozxVQMrbjrmXsuEirxy0yetP4X/MbrlHwDOYZ3h8OUM/rMeC1GfZWGLBWccnHLTfV77b94agiuNa1CujOofq3Leomou1wZKm5oZM2jwOTAql2yhbFHO4NMxUa2BaaijVn3eSnbxRTal1GttnknY8obeWiVJ0ozYtVnp2SVyHXUHOWtVYoY/YfmanJ6uwrLG8t+rMB2gpeE0reRBkgCt4pVdYuPd20HxHELTSMR9Dsoa4sGMTSw/tZOVO2xLXPhrckeZVpKNmJ6BPQRfOKayVtCNZfgwveSm4M8a1ui9Q/YOhfp4PU4U4U=
  file: better-sms-${TRAVIS_COMMIT}.crx
  skip_cleanup: true
  prerelease: true
